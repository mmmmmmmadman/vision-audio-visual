# CV Seq 呈現進化 - 討論準備指南

## 討論目標

確定 CV Seq 呈現方向的優先級和實現策略，為後續開發工作奠定基礎。

---

## 預備知識 (5 分鐘回顧)

### 當前 CV Seq 系統架構

```
攝影機 → Sobel 邊緣檢測 → 水平/垂直掃描 → SEQ1/SEQ2 (0-10V)
                                          ↓
                                      ENV1/2/3 觸發
                                          ↓
                                      ES-8 CV 輸出
```

### 三層呈現系統

1. **視訊疊加層** (contour_cv.py)
   - 邊緣線、SEQ 曲線、觸發光圈、數據面板

2. **GUI 控制層** (compact_main_window.py)
   - Column 1: 6 個 CV 控制項
   - 獨立 CV Meters 窗口 (5 通道)

3. **波形監測層** (scope_widget.py)
   - pyqtgraph 5 通道示波器

---

## 討論議題 (分類組織)

### 第一組: 視覺策略 (5 分鐘)

#### Q1: 序列模式可視化優先級

**背景**: 目前 SEQ 序列 (8-32 步) 只顯示當前步，看不到整個模式。

**選項**:
- A) 高優先 - 立即實現「序列步進網格」[●○●○...]
- B) 中優先 - 先做其他改進，後續再考慮
- C) 低優先 - 不必要，當前 slider 控制足夠

**建議**: A (視覺衝擊高，開發成本低)

---

#### Q2: 色彩編碼系統

**背景**: 現在只用 3 種顏色 (粉/白/紅)，無法有效區分 CV 強度變化。

**選項**:
- A) 保持極簡 - 使用現有 3 色
- B) 引入漸變 - 0V 暗色 → 10V 亮色的彩色漸變
- C) 多色系統 - 為每個 CV 源定義專屬色系

**建議**: B (改善信息密度，不增加視覺雜亂)

---

### 第二組: 互動設計 (5 分鐘)

#### Q3: CV 參數編輯方式

**背景**: 現在只能用 Slider 調參，多參數編輯效率低。

**選項**:
- A) 保持 Slider - 無需改變
- B) 添加表格視圖 - 批量編輯參數 (建議)
- C) 支援拖拉編輯 - 在網格上直接拖拉調整步進值

**建議**: B (提升工作流效率，風險可控)

---

#### Q4: 預設管理需求

**背景**: 沒有預設系統，無法快速切換 CV 配置。

**選項**:
- A) 不需要 - 每次手動調整
- B) 簡單預設 - 保存/加載 JSON 檔
- C) 高級預設 - 包含 Undo/Redo、預設分類等

**建議**: B (實用且易實現)

---

### 第三組: 資訊呈現 (5 分鐘)

#### Q5: 示波器增強方向

**背景**: 當前示波器為基礎波形顯示，缺乏 CV 序列和包絡資訊。

**選項**:
- A) 保持現狀 - 已經足夠
- B) 疊加 SEQ 步進點 - 在波形上標記步進位置
- C) 添加 ENV 曲線 - 顯示完整的攻擊/衰減曲線
- D) 全部實現 (建議)

**建議**: D (B+C 的複雜度不高，資訊密度明顯提升)

---

#### Q6: 統計和診斷資訊

**背景**: 無法快速了解 CV 的統計特性 (Min/Max/Avg/Variance)。

**選項**:
- A) 不需要 - 視覺反饋已足夠
- B) 顯示實時統計 - Min/Max/Avg/Variance
- C) 異常檢測 - 警告不同步、超範圍等問題
- D) 智能建議 - 基於統計的參數優化建議

**建議**: B+C (C 有較高診斷價值)

---

### 第四組: 使用場景 (5 分鐘)

#### Q7: 主要使用場景

**背景**: CV Seq 的呈現應該針對具體的使用場景優化。

**選項**:
- A) 實時表演 - 快速調整、直觀反饋最重要
- B) 工作室編輯 - 精細控制、預設管理最重要
- C) 教學演示 - 清晰展示、易於理解最重要
- D) 全部支援

**建議**: A+B (D 會導致複雜性爆炸)

---

#### Q8: 性能約束

**背景**: VAV 目前 30 FPS，新增可視化可能影響性能。

**選項**:
- A) 保持 30 FPS - 嚴格約束
- B) 允許 20-30 FPS - 稍微降低可接受
- C) GPU 加速優先 - 如果幀率下降，優化到 GPU

**建議**: A (30 FPS 對實時感受至關重要)

---

### 第五組: 技術策略 (5 分鐘)

#### Q9: 開發優先級

**背景**: 有多個改進方向，資源有限。

**選項** (按優先級排序):
1. 序列步進網格 (1-2 天)
2. 波形示波器增強 (2-3 天)
3. CV 參數編輯網格 (3-4 天)
4. 統計面板 (1-2 天)
5. 2D Lissajous 可視化 (5-7 天)
6. 完整編輯工作流 (2-3 周)
7. AI 輔助設計 (1-2 月)

**確認**: 同意以上順序？是否有調整？

---

#### Q10: 技術方案選擇

**背景**: 多個可視化方案都可行。

**選項**:
- A) 堅持 PyQt6 + OpenCV - 保持現有生態
- B) 混合 PyQt6 + pyqtgraph - 部分使用現有工具
- C) 引入 Vispy/Plotly - 更強大的可視化

**建議**: B (平衡性能和開發效率)

---

## 決策矩陣

### 推薦方案 (基於上述討論)

| 項目 | 決策 | 理由 |
|------|------|------|
| 序列模式可視化 | 高優先 (立即) | 視覺衝擊強，開發成本低 |
| 色彩系統 | 漸變編碼 | 改善資訊密度 |
| 參數編輯 | 表格 + Slider 並存 | 靈活性和易用性兼顧 |
| 預設系統 | 簡單 JSON | 快速實現高價值功能 |
| 示波器 | 疊加 SEQ + ENV | 調試能力大幅提升 |
| 統計資訊 | Min/Max/Avg + 異常檢測 | 診斷和優化工具 |
| 使用場景 | 實時表演 + 工作室編輯 | 覆蓋主要需求 |
| 性能目標 | 維持 30 FPS | 實時感受最重要 |
| 開發順序 | 按優先級 1-7 | 快速勝利優先 |
| 技術棧 | PyQt6 + pyqtgraph | 保持現有生態 |

---

## 實現路線圖 (如果同意上述決策)

### Phase 1: 快速勝利 (1-2 周)

```
Week 1:
- 序列步進網格 widget (1 天)
- Meter 迷你序列圖 (1 天)

Week 2:
- 示波器時間軸增強 (1 天)
- CV 儀表板資訊增強 (0.5 天)
```

**里程碑**: 完整的序列模式可視化

### Phase 2: 核心功能 (2-3 周)

```
Week 3-4:
- CV 參數編輯網格 (2 天)
- 預設系統 (1.5 天)
- 統計面板 (1 天)
- 波形示波器 SEQ + ENV 疊加 (1.5 天)
```

**里程碑**: 完整的 CV 編輯工作流

### Phase 3: 進階特性 (未來)

```
後續:
- 2D Lissajous (優先級 3)
- 完整編輯環境 (優先級 6)
- AI 輔助 (優先級 7)
```

---

## 討論時的快速參考

### 核心數據

| 指標 | 當前 | 目標 |
|------|------|------|
| 序列可視化 | 當前步指示 | 完整 [●○●○...] |
| 色彩編碼 | 3 種固定色 | 漸變系統 |
| 互動性 | Slider 調參 | 網格編輯 + 拖拉 |
| 預設管理 | 無 | JSON 預設 |
| 調試工具 | 基礎 meter | 統計 + 異常檢測 |
| 波形監測 | 波形顯示 | 波形 + SEQ + ENV |
| 性能 | 30 FPS | 維持 30 FPS |

### 優先級一覽

```
Quick Wins (1-2 周)
├─ 序列步進網格 ████████ 實現難度: 低
├─ Meter 迷你圖 ████░░░░ 實現難度: 低
├─ 示波器增強 ██████░░ 實現難度: 中
└─ 儀表板增強 ████░░░░ 實現難度: 低

Core Features (2-3 周)
├─ 參數編輯網格 ██████░░ 實現難度: 中
├─ 預設系統 █████░░░ 實現難度: 中
├─ 統計面板 ████░░░░ 實現難度: 低
└─ 波形增強 ██████░░ 實現難度: 中

Future (1-2 月+)
├─ 2D Lissajous ████████ 實現難度: 高
├─ 編輯工作流 ████████ 實現難度: 高
└─ AI 輔助 ██████████ 實現難度: 很高
```

---

## 討論節奏建議

1. **開場** (2 分鐘)
   - 快速回顧當前系統
   - 提出核心痛點

2. **分組討論** (30 分鐘)
   - 5 個討論議題，每個 5 分鐘
   - 投票/共識

3. **決策確認** (5 分鐘)
   - 確認推薦方案
   - 簽署決策矩陣

4. **路線圖確認** (5 分鐘)
   - 確認 Phase 1-3 計畫
   - 分配初期工作

**總時間**: ~45 分鐘

---

## 決策記錄 (討論後填寫)

討論日期: ________________

### 同意的決策

- [ ] 序列模式可視化: _____________
- [ ] 色彩編碼系統: _____________
- [ ] 參數編輯方式: _____________
- [ ] 預設管理需求: _____________
- [ ] 示波器增強方向: _____________
- [ ] 統計資訊呈現: _____________
- [ ] 主要使用場景: _____________
- [ ] 性能約束: _____________
- [ ] 開發優先級: _____________
- [ ] 技術方案: _____________

### 其他決策 / 修改

_________________________________________________________________

### 預期時間表

Phase 1 開始日期: ________________  
Phase 1 完成日期: ________________

Phase 2 開始日期: ________________  
Phase 2 完成日期: ________________

### 負責人

Phase 1 owner: ________________  
Phase 2 owner: ________________

---

## 參考文件

- **完整分析**: `CV_SEQ_EVOLUTION_ANALYSIS.md` (619 行)
- **快速摘要**: `CV_SEQ_QUICK_SUMMARY.md`
- **本文件**: `DISCUSSION_PREPARATION.md`

關鍵代碼位置:
- `vav/cv_generator/contour_cv.py` (486 行) - CV 生成邏輯
- `vav/gui/compact_main_window.py` - GUI 控制
- `vav/gui/meter_widget.py` - Meter 呈現
- `vav/gui/scope_widget.py` - 示波器呈現
- `vav/core/controller.py` - 系統控制器

